{"ast":null,"code":"import _toConsumableArray from\"/Users/christy/Documents/cxxxxxn.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/christy/Documents/cxxxxxn.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/christy/Documents/cxxxxxn.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/christy/Documents/cxxxxxn.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _createSuper from\"/Users/christy/Documents/cxxxxxn.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _inherits from\"/Users/christy/Documents/cxxxxxn.github.io/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import'./Mnavbar.css';export var MarkdownNavbar=/*#__PURE__*/function(_Component){_inherits(MarkdownNavbar,_Component);var _super=_createSuper(MarkdownNavbar);function MarkdownNavbar(props){var _this;_classCallCheck(this,MarkdownNavbar);_this=_super.call(this,props);_this.winScroll=function(){if(_this.scrollEventLock)return;var scrollTop=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;var newHeadingList=_this.getHeadingList().map(function(h){return _objectSpread({},h,{distanceToTop:Math.abs(scrollTop+_this.props.headingTopOffset-h.offsetTop)});});var distanceList=newHeadingList.map(function(h){return h.distanceToTop;});var minDistance=Math.min.apply(Math,_toConsumableArray(distanceList));var curHeading=newHeadingList.find(function(h){return h.distanceToTop===minDistance;});_this.setState({currentListNo:curHeading.listNo});};_this.state={currentListNo:''};return _this;}_createClass(MarkdownNavbar,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;if(this.addTargetTimeout){clearTimeout(this.addTargetTimeout);}this.addTargetTimeout=setTimeout(function(){_this2.initHeadingsId();document.addEventListener('scroll',_this2.winScroll,false);},500);}},{key:\"shouldComponentUpdate\",value:function shouldComponentUpdate(nextProps){var _this3=this;if(nextProps.source!==this.props.source){if(this.scrollEventLockTimer){clearTimeout(this.scrollEventLockTimer);}this.scrollEventLock=true;window.scrollTo(0,0);// window.history.replaceState(\n//     {},\n//     '',\n//     `${window.location.pathname}${window.location.search}`\n// );\nthis.setState({currentListNo:''});var headings=document.querySelectorAll('h1, h2, h3, h4, h5, h6');Array.prototype.slice.apply(headings).forEach(function(h){return h.dataset.id='';});this.scrollEventLockTimer=setTimeout(function(){_this3.initHeadingsId();_this3.scrollEventLock=false;},500);}return true;}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){if(this.addTargetTimeout){clearTimeout(this.addTargetTimeout);}if(this.scrollTimeout){clearTimeout(this.scrollTimeout);}document.removeEventListener('scroll',this.winScroll,false);}},{key:\"getNavStructure\",value:function getNavStructure(){var contentWithoutCode=this.props.source.replace(/^[^#]+\\n/g,'').replace(/^#\\s[^#\\n]*\\n+/,'').replace(/```[^`\\n]*\\n+[^```]+```\\n+/g,'').replace(/`([^`\\n]+)`/g,'$1').replace(/\\*\\*?([^*\\n]+)\\*\\*?/g,'$1').replace(/__?([^_\\n]+)__?/g,'$1').trim();var pattOfTitle=/#+\\s([^#\\n]+)\\n*/g;var matchResult=contentWithoutCode.match(pattOfTitle);if(!matchResult){return[];}var navData=matchResult.map(function(r,i){return{index:i,level:r.match(/^#+/g)[0].length,text:r.replace(pattOfTitle,'$1')};});var levelCount=function levelCount(level){return navData.filter(function(r){return r.level===level;}).length;};var startLevel=1;var startLevelCount=levelCount(startLevel);while(!startLevelCount){startLevel+=1;startLevelCount=levelCount(startLevel);}var listNo=1;navData.forEach(function(t){if(t.level===startLevel){t.listNo=listNo.toString();listNo+=1;}});navData.forEach(function(t,i){if(!t.listNo){if(navData[i-1]&&t.level===navData[i-1].level+1){t.listNo=\"\".concat(navData[i-1].listNo,\".1\");}else if(navData[i-1]&&t.level===navData[i-1].level){t.listNo=navData[i-1].listNo.replace(/^(.+\\.)(\\d+)$/g,function(w,$1,$2){return\"\".concat($1).concat(parseInt($2,10)+1);});}else{t.listNo='';}}});var result=navData.map(function(nav){return _objectSpread({},nav,{listNo:nav.listNo.indexOf('.')<0?\"\".concat(nav.listNo,\".\"):nav.listNo,text:nav.text});});return result;}},{key:\"scrollToTarget\",value:function scrollToTarget(dataId){var _this4=this;if(this.scrollTimeout){clearTimeout(this.scrollTimeout);}this.scrollTimeout=setTimeout(function(){var target=document.querySelector(\"[data-id=\\\"\".concat(dataId,\"\\\"]\"));if(target&&typeof target.offsetTop==='number'){window.scrollTo(0,target.offsetTop-_this4.props.headingTopOffset);}},0);}},{key:\"initHeadingsId\",value:function initHeadingsId(){var _this5=this;var headingId=decodeURIComponent('');this.getNavStructure().forEach(function(t){var headings=document.querySelectorAll(\"h\".concat(t.level));var curHeading=Array.prototype.slice.apply(headings).find(function(h){return h.innerText===t.text&&(!h.dataset||!h.dataset.id);});if(curHeading){curHeading.dataset.id=\"heading-\".concat(t.index);if(headingId&&headingId===curHeading.dataset.id){_this5.scrollToTarget(headingId);_this5.setState({currentListNo:t.listNo});}}});}},{key:\"getHeadingList\",value:function getHeadingList(){var headingList=[];this.getNavStructure().forEach(function(t){var headings=document.querySelectorAll(\"h\".concat(t.level));var curHeading=Array.prototype.slice.apply(headings).find(function(h){return h.innerText===t.text&&!headingList.find(function(x){return x.offsetTop===h.offsetTop;});});if(curHeading){headingList.push({dataId:\"heading-\".concat(t.index),listNo:t.listNo,offsetTop:curHeading.offsetTop});}});return headingList;}},{key:\"render\",value:function render(){var _this6=this;var tBlocks=this.getNavStructure().map(function(t){var cls=\"title-anchor title-level\".concat(t.level,\" \").concat(_this6.state.currentListNo===t.listNo?'active':'');return/*#__PURE__*/React.createElement(\"div\",{className:cls,onClick:function onClick(evt){var currentHash=\"heading-\".concat(t.index);// Nav item clicking callback\n_this6.props.onNavItemClick(evt,evt.target,currentHash);_this6.scrollToTarget(currentHash);_this6.setState({currentListNo:t.listNo});},key:\"title_anchor_\".concat(t.index)},_this6.props.ordered?/*#__PURE__*/React.createElement(\"small\",null,t.listNo):null,t.text);});return/*#__PURE__*/React.createElement(\"div\",{className:\"markdown-navigation \".concat(this.props.className)},tBlocks);}}]);return MarkdownNavbar;}(Component);MarkdownNavbar.defaultProps={source:'',ordered:false,headingTopOffset:0,declarative:false,className:'',onNavItemClick:function onNavItemClick(){}};export default MarkdownNavbar;","map":{"version":3,"sources":["/Users/christy/Documents/cxxxxxn.github.io/src/views/NoteDetail/Mnavbar.js"],"names":["React","Component","MarkdownNavbar","props","winScroll","scrollEventLock","scrollTop","window","pageYOffset","document","documentElement","body","newHeadingList","getHeadingList","map","h","distanceToTop","Math","abs","headingTopOffset","offsetTop","distanceList","minDistance","min","curHeading","find","setState","currentListNo","listNo","state","addTargetTimeout","clearTimeout","setTimeout","initHeadingsId","addEventListener","nextProps","source","scrollEventLockTimer","scrollTo","headings","querySelectorAll","Array","prototype","slice","apply","forEach","dataset","id","scrollTimeout","removeEventListener","contentWithoutCode","replace","trim","pattOfTitle","matchResult","match","navData","r","i","index","level","length","text","levelCount","filter","startLevel","startLevelCount","t","toString","w","$1","$2","parseInt","result","nav","indexOf","dataId","target","querySelector","headingId","decodeURIComponent","getNavStructure","innerText","scrollToTarget","headingList","x","push","tBlocks","cls","evt","currentHash","onNavItemClick","ordered","className","defaultProps","declarative"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './Mnavbar.css';\n\nexport class MarkdownNavbar extends Component {\n    static defaultProps = {\n        source: '',\n        ordered: false,\n        headingTopOffset: 0,\n        declarative: false,\n        className: '',\n        onNavItemClick: () => {},\n    };\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            currentListNo: '',\n        };\n    }\n\n    componentDidMount() {\n        if (this.addTargetTimeout) {\n            clearTimeout(this.addTargetTimeout);\n        }\n            this.addTargetTimeout = setTimeout(() => {\n            this.initHeadingsId();\n            document.addEventListener('scroll', this.winScroll, false);\n        }, 500);\n    }\n\n    shouldComponentUpdate(nextProps) {\n        if (nextProps.source !== this.props.source) {\n            if (this.scrollEventLockTimer) {\n                clearTimeout(this.scrollEventLockTimer);\n            }\n            this.scrollEventLock = true;\n\n            window.scrollTo(0, 0);\n            // window.history.replaceState(\n            //     {},\n            //     '',\n            //     `${window.location.pathname}${window.location.search}`\n            // );\n            this.setState({\n                currentListNo: '',\n            });\n\n            const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');\n            Array.prototype.slice.apply(headings).forEach(h => (h.dataset.id = ''));\n\n            this.scrollEventLockTimer = setTimeout(() => {\n                this.initHeadingsId();\n                this.scrollEventLock = false;\n            }, 500);\n        }\n        return true;\n    }\n\n    componentWillUnmount() {\n        if (this.addTargetTimeout) {\n            clearTimeout(this.addTargetTimeout);\n        }\n        if (this.scrollTimeout) {\n            clearTimeout(this.scrollTimeout);\n        }\n        document.removeEventListener('scroll', this.winScroll, false);\n    }\n\n    getNavStructure() {\n        const contentWithoutCode = this.props.source\n        .replace(/^[^#]+\\n/g, '')\n        .replace(/^#\\s[^#\\n]*\\n+/, '')\n        .replace(/```[^`\\n]*\\n+[^```]+```\\n+/g, '')\n        .replace(/`([^`\\n]+)`/g, '$1')\n        .replace(/\\*\\*?([^*\\n]+)\\*\\*?/g, '$1')\n        .replace(/__?([^_\\n]+)__?/g, '$1')\n        .trim();\n\n        const pattOfTitle = /#+\\s([^#\\n]+)\\n*/g;\n        const matchResult = contentWithoutCode.match(pattOfTitle);\n\n        if (!matchResult) {\n        return [];\n        }\n\n        const navData = matchResult.map((r, i) => ({\n        index: i,\n        level: r.match(/^#+/g)[0].length,\n        text: r.replace(pattOfTitle, '$1'),\n        }));\n\n        const levelCount = level => navData.filter(r => r.level === level).length;\n        let startLevel = 1;\n        let startLevelCount = levelCount(startLevel);\n        while (!startLevelCount) {\n        startLevel += 1;\n        startLevelCount = levelCount(startLevel);\n        }\n\n        let listNo = 1;\n        navData.forEach(t => {\n        if (t.level === startLevel) {\n            t.listNo = listNo.toString();\n            listNo += 1;\n        }\n        });\n\n        navData.forEach((t, i) => {\n        if (!t.listNo) {\n            if (navData[i - 1] && t.level === navData[i - 1].level + 1) {\n            t.listNo = `${navData[i - 1].listNo}.1`;\n            } else if (navData[i - 1] && t.level === navData[i - 1].level) {\n            t.listNo = navData[i - 1].listNo.replace(\n                /^(.+\\.)(\\d+)$/g,\n                (w, $1, $2) => `${$1}${parseInt($2, 10) + 1}`\n            );\n            } else {\n            t.listNo = '';\n            }\n        }\n        });\n\n        const result = navData.map(nav => ({\n        ...nav,\n        listNo: nav.listNo.indexOf('.') < 0 ? `${nav.listNo}.` : nav.listNo,\n        text: nav.text,\n        }));\n\n        return result;\n    }\n\n    scrollToTarget(dataId) {\n        if (this.scrollTimeout) {\n        clearTimeout(this.scrollTimeout);\n        }\n\n        this.scrollTimeout = setTimeout(() => {\n        const target = document.querySelector(`[data-id=\"${dataId}\"]`);\n        if (target && typeof target.offsetTop === 'number') {\n            window.scrollTo(0, target.offsetTop - this.props.headingTopOffset);\n        }\n        }, 0);\n    }\n\n    initHeadingsId() {\n        const headingId = decodeURIComponent('');\n\n        this.getNavStructure().forEach(t => {\n        const headings = document.querySelectorAll(`h${t.level}`);\n        const curHeading = Array.prototype.slice\n            .apply(headings)\n            .find(h => h.innerText === t.text && (!h.dataset || !h.dataset.id));\n\n        if (curHeading) {\n            curHeading.dataset.id = `heading-${t.index}`;\n\n            if (headingId && headingId === curHeading.dataset.id) {\n            this.scrollToTarget(headingId);\n            this.setState({\n                currentListNo: t.listNo,\n            });\n            }\n        }\n        });\n    }\n\n    getHeadingList() {\n        const headingList = [];\n\n        this.getNavStructure().forEach(t => {\n        const headings = document.querySelectorAll(`h${t.level}`);\n        const curHeading = Array.prototype.slice\n            .apply(headings)\n            .find(\n            h =>\n                h.innerText === t.text &&\n                !headingList.find(x => x.offsetTop === h.offsetTop)\n            );\n        if (curHeading) {\n            headingList.push({\n            dataId: `heading-${t.index}`,\n            listNo: t.listNo,\n            offsetTop: curHeading.offsetTop,\n            });\n        }\n        });\n\n        return headingList;\n    }\n\n    winScroll = () => {\n        if (this.scrollEventLock) return;\n\n        const scrollTop =\n            window.pageYOffset ||\n            document.documentElement.scrollTop ||\n            document.body.scrollTop ||\n            0;\n\n        const newHeadingList = this.getHeadingList().map(h => ({\n            ...h,\n            distanceToTop: Math.abs(\n                scrollTop + this.props.headingTopOffset - h.offsetTop\n            ),\n            }));\n        const distanceList = newHeadingList.map(h => h.distanceToTop);\n        const minDistance = Math.min(...distanceList);\n        const curHeading = newHeadingList.find(\n            h => h.distanceToTop === minDistance\n        );\n\n        this.setState({\n            currentListNo: curHeading.listNo,\n        });\n    };\n\n    render() {\n        const tBlocks = this.getNavStructure().map(t => {\n            const cls = `title-anchor title-level${t.level} ${\n                this.state.currentListNo === t.listNo ? 'active' : ''\n            }`;\n\n            return (\n                <div\n                    className={cls}\n                    onClick={evt => {\n                        const currentHash = `heading-${t.index}`;\n\n                        // Nav item clicking callback\n                        this.props.onNavItemClick(evt, evt.target, currentHash);\n                        this.scrollToTarget(currentHash);\n                        this.setState({\n                            currentListNo: t.listNo,\n                        });\n                    }}\n                    key={`title_anchor_${t.index}`}>\n                    {this.props.ordered ? <small>{t.listNo}</small> : null}\n                    {t.text}\n                </div>\n            );\n        });\n\n        return (\n            <div className={`markdown-navigation ${this.props.className}`}>\n                {tBlocks}\n            </div>\n        );\n    }\n}\n\nexport default MarkdownNavbar;\n"]},"metadata":{},"sourceType":"module"}